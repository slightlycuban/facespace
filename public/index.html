<!DOCTYPE html>
<html>
	<head>
		<title>The Website of Michael Tracy</title>
		<meta charset="utf-8">
		<link rel="stylesheet" href="/css/styles.css">
    <script src="js/jquery.min.js"></script>
    <script>
      $(function() {
        var $github = $('#github');
        $.ajax({
          url: "https://api.github.com/users/slightlycuban/events/public?number=1",
          dataType: 'json',
          success: function(events) {
            var push = events[0];
            if (push.type !== "PushEvent") {
              return;
            }
            
            var commit = push.payload.commits[0];
            $github.append('<p id="message"><a href="' + commit.url + '">' + commit.message + '</a></p><p><span class="sha">' + commit.sha + '</span></p>');

            $.ajax({
              url: push.repo.url,
              dataType: 'json',
              success: function(repo) {
                $github.append('<p>In <a href="' + repo.html_url +'">' + repo.name + '</a></p>');
              }
            });
          }
        });

        $wordpress = $("#wordpress");
        $.ajax({
          url: 'https://public-api.wordpress.com/rest/v1/sites/exiledpenguin.wordpress.com/posts/?number=1&callback=?',
          dataType: 'json',
          success: function(feed) {
            var post = feed.posts[0];
            $wordpress.append('<p><a href="' + post.URL + '">' + post.title + '</a></p>');
            $wordpress.append('<p>On ' + post.date + '</p>')
          }
        });

        $so = $("#so");
        $.ajax({
          url: 'https://api.stackexchange.com/2.1/users/2372767/answers?page=1&pagesize=1&order=desc&sort=activity&site=stackoverflow',
          dataType: 'json',
          success: function(profile) {
            var answer = profile.items[0];

            $.ajax({
              url: 'https://api.stackexchange.com/2.1/questions/' + answer.question_id + '?order=desc&sort=activity&site=stackoverflow',
              dataType: 'json',
              success: function(results) {
                var question = results.items[0];
                $so.append('<p>In <a href="' + question.link + '">' + question.title + '</a></p>');
                $so.append('<p>With a score of ' + answer.score + '</p>');
              }
            });
          }
        });
      });

      $(document).ajaxError(function( event, jqxhr, settings, exception ) {
        console.log(event);
        console.log(exception);
        console.log(settings);
      });
    </script>
	</head>
	<body class="container">
		<header class="page-header media">
			<h1>Michael Tracy</h1>
			<p>A place for me to put stuff</p>
		</header>
		<div class=row>
			<nav class="span1">
				<ul class="nav">
					<li><a href="https://github.com/michaeltracy/">Github</a></li>
					<li><a href="https://twitter.com/slightlycuban">Twitter</a></li>
					<li><a href="https://exiledpenguin.wordpress.com/">Blog</a></li>
				</ul>
			</nav>
			<div class="span11">
			</div>
		</div>
    <div class="row">
      <div class="span4" id="github">
        <h4>Latest commit:</h4>
      </div>
      <div class="span4" id="wordpress">
        <h4>Latest post:</h4>
      </div>
      <div class="span4" id="so">
        <h4>Latest answer:</h4>
      </div>
    </div>
		<hr>
		<footer class="page-footer">
			<p>&copy; 2013 Michael Tracy</p>
		</footer>
	</body>
</html>
